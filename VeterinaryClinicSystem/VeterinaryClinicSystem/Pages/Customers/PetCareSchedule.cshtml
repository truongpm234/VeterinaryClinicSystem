@page
@model VeterinaryClinicSystem.Pages.Customers.PetCareScheduleModel
@{
    ViewData["Title"] = "Lịch tiêm phòng";
}
<h2>Lịch tiêm phòng của thú cưng: @Model.Pet.Name</h2>

@if (!Model.Schedules.Any())
{
    <div class="alert alert-warning">❌ Thú cưng này chưa có lịch tiêm phòng.</div>

    <button id="showFormBtn" class="btn btn-outline-primary">📅 Tạo lịch tiêm phòng</button>

    <div id="careForm" class="mt-3 d-none">
        <form method="post">
            <input type="hidden" asp-for="NewCareType" value="Tiêm phòng" />
            <div class="form-group">
                <label>Ngày tiêm lần 1</label>
                <input asp-for="InitialDate"
                       type="date"
                       class="form-control"
                       value="@Model.InitialDate.ToString("yyyy-MM-dd")"
                       required />
            </div>
            <button type="submit" class="btn btn-success mt-2">💉 Xác nhận tạo lịch</button>
        </form>
    </div>
}
else
{
    <table class="table table-bordered">
        <thead>
            <tr>
                <th>Loại chăm sóc</th>
                <th>Ngày tiêm lần 1</th>
                <th>Ngày tiêm nhắc lại</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var s in Model.Schedules)
            {
                <tr>
                    <td>@s.CareType</td>
                    <td>@s.InitialDate.ToString("yyyy-MM-dd")</td>
                    <td>@s.NextDueDate?.ToString("yyyy-MM-dd")</td>
                </tr>
            }
        </tbody>
    </table>
}
@section Scripts {
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const showBtn = document.getElementById("showFormBtn");
            const form = document.getElementById("careForm");

            if (showBtn && form) {
                showBtn.addEventListener("click", function () {
                    form.classList.remove("d-none");
                    showBtn.style.display = "none";
                });
            }
        });
    </script>
}
